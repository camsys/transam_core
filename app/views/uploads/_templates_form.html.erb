<%= dialog_tag('Select Template and Asset Type', {:icon => 'fa fa-upload', :class => "header-part"}) do %>	
	<%= simple_form_for(:template_proxy, :url => create_template_uploads_url, :method => "post", :html => {:id => 'template_form', :class => 'form-horizontal'}, :wrapper => :horizontal_form, :wrapper_mappings => {:check_boxes => :horizontal_radio_and_checkboxes}) do |f| %>
		<%= f.input :file_content_type, :collection => FileContentType.all, :include_blank => false, :label => "File Content Type" %>
		<div id="asset_type_input">	
			<%# Only make available the AssetTypes handled in StatusUpdateFileHandler AND DispositionUpdateFileHandler %>
			<%= f.input :asset_type, :collection => AssetType.where(class_name: %w(Locomotive RailCar Vehicle)), :label => "Asset Type", :include_blank => false %>	
		</div>
		<div id="all_asset_types_input">	
			<%# Only make available the AssetTypes with InventoryLoaders %>
			<%= f.input :asset_type, :collection => (AssetType.where(class_name: %w(Locomotive RailCar Vehicle))), :label => "Asset Type", :include_blank => false %>	
		</div>
		<div class='col-sm-offset-3 class-sm-9'>
			<%= f.button :submit, 'Download Template', :class => 'btn btn-primary' %>
		</div>			
	<% end %>
<% end %>

<script type="text/javascript">

	$(document).ready(function() {
		var set_input_visibility = function(val) {
			if (val == 1) {
				// Hide the other input
				$('#asset_type_input').hide().find("select").prop("disabled", true);
				$('#all_asset_types_input').show().find("select").prop("disabled", false);
			} else {
				// Unhide id
				$('#asset_type_input').show().find("select").prop("disabled", false);
				$('#all_asset_types_input').hide().find("select").prop("disabled", true);
			}
		}
		// Hide the asset type div when the page is loaded
		set_input_visibility($('#template_proxy_file_content_type_id').val());
		
		// Install a change handler to unhide the div if the user selects other than
		// the new inventory selector
		$('#template_proxy_file_content_type_id').change(function() {
			var val = this.value;
			set_input_visibility(val);
		});
	});
		
</script>
